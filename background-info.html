

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Introduction to optical observations &#8212; AIfA telescope data reduction tutorial</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'background-info';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Structure and Python tools" href="overview-pythontools.html" />
    <link rel="prev" title="Requirements and installation" href="installation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="AIfA telescope data reduction tutorial - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="AIfA telescope data reduction tutorial - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    AIfA telescope data reduction tutorial
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Setup and theory</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Requirements and installation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Introduction to optical observations</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview-pythontools.html">Structure and Python tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Setting up the data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Basic reduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pre-red.html">Image pre-reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="photometry.html">Photometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="CMD.html">Colour Magnitude Diagram</a></li>
<li class="toctree-l1"><a class="reference internal" href="lightcurve.html">Light curve</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Further pages</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="astrometry.html">Astrometric calibration</a></li>
<li class="toctree-l1"><a class="reference internal" href="stack.html">Reprojecting, stacking and colour-combination</a></li>
<li class="toctree-l1"><a class="reference internal" href="more.html">References and links</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo.html">Test page</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/aifatelescope/datared" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/aifatelescope/datared/issues/new?title=Issue%20on%20page%20%2Fbackground-info.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/background-info.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Introduction to optical observations</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#telescope-optics">Telescope optics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resolution">Resolution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seeing-and-airmass">Seeing and airmass</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imaging-instrument-the-camera">Imaging instrument: the camera</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imaging-detectors-ccd-or-cmos">Imaging detectors (CCD or CMOS)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#full-well-capacity">Full-well capacity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adc-adu-and-gain">ADC, ADU, and gain</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bit-depth">Bit depth</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bias-level">Bias level</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dark-current">Dark current</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#astronomical-images">Astronomical images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fits">FITS</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calibration-frames">Calibration frames</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#artifacts-and-cosmic-rays">Artifacts and cosmic rays ?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wcs-distortions">WCS, distortions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coaddition">Coaddition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#photometry">Photometry</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="introduction-to-optical-observations">
<h1>Introduction to optical observations<a class="headerlink" href="#introduction-to-optical-observations" title="Permalink to this heading">#</a></h1>
<p>This page summarizes important concepts concerning observations in optical astronomy, gives definitions that are essential to understanding the tutorial, and touches some very practical points. It’s kept as short as possible.</p>
<section id="telescope-optics">
<h2>Telescope optics<a class="headerlink" href="#telescope-optics" title="Permalink to this heading">#</a></h2>
<p>A reflecting telescope uses a combination of (curved) mirrors to form an image in its so-called focal plane, also known as the image plane.
The optical design of the AIfA telescope is a <strong>variation of a Cassegrain</strong> telescope, illustrated below.</p>
<figure class="align-default" id="cassegrain-layout">
<a class="reference internal image-reference" href="_images/cassegrain_layout.png"><img alt="_images/cassegrain_layout.png" src="_images/cassegrain_layout.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">Optical layout of a Cassegrain telescope</span><a class="headerlink" href="#cassegrain-layout" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The in-falling light first meets the concave primary mirror (M1) to be then re-reflected by the convex secondary mirror (M2). The light gets collimated in the focal plane, after passing through an opening in M1. Due to the folding of its optical path, such a Cassegrain system allows for a compact construction. More precisely, the AIfA telescope is a  “<a class="reference external" href="https://www.planewave.eu/en/technologies/cdk-optical-design">corrected Dall-Kirkham</a>” telescope, where M1 is ellipsoidal with a diameter of 35 cm (the <strong>aperture</strong> of the telescope), M2 is spherical, and an additional lens group located before the focal plane, roughly in the opening of M1, corrects the design against aberrations on a wide and flat focal plane.</p>
</section>
<section id="resolution">
<h2>Resolution<a class="headerlink" href="#resolution" title="Permalink to this heading">#</a></h2>
<p>Due to diffraction, a telescope has a finite <a class="reference external" href="https://en.wikipedia.org/wiki/Angular_resolution">angular resolution</a>. Note that this notion of resolution is <em>not</em> related to the sampling by a camera (i.e., pixel size), discussed later. Instead, it is a fundamental property of the optical system.</p>
<p>The light distribution in the image plane resulting from an (apparently) point-like source (star) is termed <strong>point-spread function (PSF)</strong>.
In the idealised (so-called <em>diffraction-limited</em>) case, the PSF of a circular aperture is given by the <a class="reference external" href="https://en.wikipedia.org/wiki/Airy_disk">Airy disc</a>. Using the Rayleigh criterion for spatial resolution, a telescope of primary aperture <span class="math notranslate nohighlight">\(D\)</span> at a wavelength <span class="math notranslate nohighlight">\(\lambda\)</span> is in principle capable of resolving structure with an angular separation (in radians) of</p>
<div class="math notranslate nohighlight">
\[
\Delta \theta = 1.22 \frac{\lambda}{D}. 
\]</div>
<div class="admonition-question admonition">
<p class="admonition-title">Question</p>
<p>What’s the diffraction-limited angular resolution of a telescope with an aperture of 35 cm, at a wavelength of 700 nm, in arcseconds?</p>
</div>
<p>As we’ll see in the following, for simple ground-based telescopes, the actual resolution will be lower, due to the effects of Earth’s atmosphere.</p>
</section>
<section id="seeing-and-airmass">
<h2>Seeing and airmass<a class="headerlink" href="#seeing-and-airmass" title="Permalink to this heading">#</a></h2>
<p>For ground-based astronomical observations, Earth’s atmosphere has to be considered as part of the optical system, leading to numerous effects. Most importantly, turbulence in the atmosphere leads to variations of the refractive index on short spatial and temporal scales. The “instantaneous” image of a star seen in the telescope is no longer an Airy disc, but has an irregular shape that randomly changes and moves around. When integrating an image with any exposure time longer than about a tenth of a second, this results in a blurring of the PSF. The PSF of such a long exposure can to some extent be represented by a two-dimensional Gaussian (a better approximation is given by the Moffat profile).</p>
<p>The size of such a stellar image, as given by the <strong>full width at half maximum (FWHM)</strong> of the Gaussian, is called the <strong>seeing</strong> of the image and measures the actual resolution in a particular observation. The less turbulent the atmosphere, the higher the resolution and thus the data quality that can be achieved. For Bonn, a seeing of 2 arcsec is a very rare and good value, while in excellent locations like Hawaii or the Atacama desert 0.5 arcsec are common.</p>
<p>The best possible observing conditions are achieved near the zenith, where the length of the light path through the atmosphere is minimal. On the contrary, extinction and disturbing seeing effects get worse for observations at lower elevations. These effects are often expressed in terms of the object’s <strong>airmass</strong> <span class="math notranslate nohighlight">\(a\)</span>, which tells you through how much atmosphere (column density) the light travels compared to vertical in-fall. For an angular distance <span class="math notranslate nohighlight">\(z\)</span> from the zenith (zenith = in vertical direction from the ground) it can in good approximation be computed as <span class="math notranslate nohighlight">\(a = 1 / \cos(z)\)</span> such that <span class="math notranslate nohighlight">\(a = 1\)</span> for an object at the zenith and formally <span class="math notranslate nohighlight">\(a = \infty\)</span> at the horizon.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Both the diffraction-limited resolution of a telescope and the seeing are wavelength-dependent!
The diffraction-limited image would be sharpest for shorter wavelength. But refraction of visible light in the atmosphere (that is a medium with normal dispersion) is <em>stronger</em> for short wavelengths than it is for long wavelengths. Therefore, assuming similar atmospheric conditions, an image taken in a red (or infrared) filter will be sharper than an image in a blue filter!</p>
</div>
</section>
<section id="imaging-instrument-the-camera">
<h2>Imaging instrument: the camera<a class="headerlink" href="#imaging-instrument-the-camera" title="Permalink to this heading">#</a></h2>
<p>A <em>camera</em> is an instrument attached to the telescope, such that the camera’s imaging sensor (sometimes also called detector) lies in the focal plane of the telescope. The sensor in the camera will <em>sample</em> the image, by recording the intensity of the light in an array of <em>pixels</em> (short for picture elements).</p>
<p>While the sensors used in optical astronomy can virtually <em>count</em> individual photons, they are not sensitive to their wavelength. Therefore, two obtain any kind of color information, a filter needs to be placed in the optical path before the imaging sensor. In practice, several filters are mounted into a filter wheel which is located in front of the sensor, allowing for a fast filter change.</p>
<p>The combination of a camera with a telescope yields a particular size of the field of view, and a resulting pixel scale. The pixel scale corresponds to the angular size a pixel subtends on the sky, and is expressed in arcseconds. For example, the camera used at the 35 cm AIfA telescope has a field of 48 arcmin by 32 arcmin, and a pixel scale of 0.3 arcsec. Given how small these pixels are compared to the typical seeing, we systematically operate the camera with a “2x2 binning”, meaning in this particular case that adjacent pixels are summed together in groups of 2x2 pixels, with the benefit of reduced file size. <strong>The effective pixel size of those images is 0.607 arcsec.</strong></p>
</section>
<section id="imaging-detectors-ccd-or-cmos">
<h2>Imaging detectors (CCD or CMOS)<a class="headerlink" href="#imaging-detectors-ccd-or-cmos" title="Permalink to this heading">#</a></h2>
<p>Modern optical cameras use electronic sensors: the incoming photons create free electrons in silicon, and these free electrons are collected in potential wells, before being read out once the desired exposure time completed.
Two types of sensors for optical astronomy cameras are CCD and CMOS chips. A key difference between these is about where and how the collected charges in each pixel are amplified and converted to a digital signal: for the CCD, many pixels are read out by a single amplifier one after the other (with the charges of these pixels being transfered pixel to pixel towards the amplifier), while for the CMOS, each pixel has its own amplifier directly attached to it.</p>
<p>Historically, CCDs where better suited for astronomical imaging (mainly due to lower noise and higher sensitivity).
Hence, most of the literature on astronomical image reduction is about CCDs. But CMOS sensors have now caught up for many applications, and the camera used at the AIfA telescope uses a CMOS sensor.
In the scope of this tutorial, we will pass over the rather minor differences in the optimal processing of CCD or CMOS data. The general ideas that we will implement can be equally applied to both detectors.</p>
<p>We now describe some nomenclature as well as important aspects of these sensors. These are equally applicable to both types.</p>
<section id="full-well-capacity">
<h3>Full-well capacity<a class="headerlink" href="#full-well-capacity" title="Permalink to this heading">#</a></h3>
<p>The charge capacity of CCD pixels is limited. The maximum number of electrons fitting into a single pixel is called full well capacity or simply “full well”. Typical scientific sensors have a full well of the order of <span class="math notranslate nohighlight">\(10^5\)</span> electrons. If the charge level is approaching full well the signal is getting non-linear and charges may spill over into adjacent pixels. Note that the full-well capacity is a physical property of the sensor’s pixels, and not just a “software issue” about how the pixel values are stored in a computer.</p>
</section>
<section id="adc-adu-and-gain">
<h3>ADC, ADU, and gain<a class="headerlink" href="#adc-adu-and-gain" title="Permalink to this heading">#</a></h3>
<p>After the exposure, the electrons captured in a pixel get amplified, and the resulting potential is then converted to a digital number (the pixel value) by an electronic circuit called <strong>Analog-to-Digital Converter (ADC)</strong>. For clarity, one attaches a “unit” to these digital numbers: pixel values are quoted in <strong>ADU</strong>, which is an acronym for <em>Analog to Digital Unit</em>. It is important to distinguish ADUs and numbers of electrons: these are different values! One defines the <strong>gain</strong> of the detector as the differential change in charge that produces a change of one ADU (e.g., 0.6 e/ADU). In other words, this gain can be seen as the conversion factor between electrons and ADU (assuming an idealized detector with constant gain). This gain is set by the amplifier and the ADC.</p>
</section>
<section id="bit-depth">
<h3>Bit depth<a class="headerlink" href="#bit-depth" title="Permalink to this heading">#</a></h3>
<p>The bit depth is the number of bits used to express pixel values. It is a property of the ADC, and later of the image file.
For example, a common ADC with 16 bits (unsigned) gives <span class="math notranslate nohighlight">\(2^{16} = 65536\)</span> (positive) integer values.
The gain of an ADC is usually adjusted so that ADC saturates in the linear regime of the CCD, <em>before</em> the full-well capacity is reached. In this way, when we observe a pixel to have a value lower than 65536 ADU, we can be sure that we did not saturate the charge capacity of that pixel.</p>
<p>Note that raw images have integer pixel values. Once we process these images, we typically use floats.</p>
</section>
<section id="bias-level">
<h3>Bias level<a class="headerlink" href="#bias-level" title="Permalink to this heading">#</a></h3>
<p>The bias level or simply <em>bias</em> is a small negative potential added by the electronics before the analog-to-digital conversion.
This bias is needed to keep any fluctuations (noise) in the conversion range of the ADC. Without bias, empty pixels would randomly show positive or negative potentials due to noise of the amplification, and these fluctuations would then get truncated by the ADC as it can only handle positive inputs.</p>
<p>The bias level results in an additive offset on the image: when an empty CCD is read out, one will still get positive numbers. As we will see, it’s a priori trivial to measure and remove this effect from the acquired images. Note however that the origin of this offset is an analogue signal. The bias level is not perfectly stable, it can drift with time, and in particular for CCD sensors it can fluctuate during readout, resulting in stripes of the image having different bias level.</p>
</section>
<section id="dark-current">
<h3>Dark current<a class="headerlink" href="#dark-current" title="Permalink to this heading">#</a></h3>
</section>
</section>
<section id="astronomical-images">
<h2>Astronomical images<a class="headerlink" href="#astronomical-images" title="Permalink to this heading">#</a></h2>
<figure class="align-default" id="image-basics">
<a class="reference internal image-reference" href="_images/image_basics.png"><img alt="_images/image_basics.png" src="_images/image_basics.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">Illustration of some basic image properties. Top: two stars (one has twice the flux of the other, but their FWHM is the same), and one galaxy. Bottom: horizontal section across the image, with pixel value on the y-axis.</span><a class="headerlink" href="#image-basics" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Images of stars are not “point-like”, but follow the profile of the <em>Point Spread Function</em> (PSF). For images obtained by simple ground-based telescopes, the origin of the PSF is dominated by <strong>astronomical seeing</strong>, that is by refraction in bubbles of air with varying refractive index, which are rapidly moving through the line of sight due to atmospheric turbulence. The images we record through those telescopes get blurred by this PSF. Mathematically, the observed image can be seen as a convolution of the actual scene with this PSF, sampled on the pixel array of the detector.</p></li>
<li><p>The PSF is wavelength-dependent. In a medium with normal dispersion (such as air), refraction is stronger for shorter wavelengths. Therefore ground-based images obtained through a red filter will be significantly sharper than images in a blue band.</p></li>
<li><p>On a ground-based image from an idealized detector, the PSF is relatively close to a Gaussian. If stars have the same spectrum (or if you use a very narrow filter) then these profiles have <em>the same width</em>, for example as measured by the <em>Full Width at Half Maximum</em> (<strong>FWHM</strong>, see figure above) of the stars. The same holds for the standard-deviation of a 2D-Gaussian fitted to these stars.</p></li>
<li><p>When displaying an image, brighter stars do have wider <em>isophotes</em> (i.e., curve around the star at a given brightness level) and therefore appear “larger”, even if the FWHM is the same for stars (see figure above).</p></li>
<li><p>Sources of noise:</p>
<ul>
<li><p>photon noise aka “shot noise” (photons hitting each pixel follow a poisson process), from the source but also from the so-called “background” (in fact, a foreground: sky brightness).</p></li>
<li><p>readout noise of electronics</p></li>
</ul>
</li>
</ul>
</section>
<section id="fits">
<h2>FITS<a class="headerlink" href="#fits" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>HDU</p></li>
</ul>
</section>
<section id="calibration-frames">
<h2>Calibration frames<a class="headerlink" href="#calibration-frames" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Flat difficulty, color dependence</p></li>
</ul>
</section>
<section id="artifacts-and-cosmic-rays">
<h2>Artifacts and cosmic rays ?<a class="headerlink" href="#artifacts-and-cosmic-rays" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Hot pixels</p></li>
</ul>
</section>
<section id="wcs-distortions">
<h2>WCS, distortions<a class="headerlink" href="#wcs-distortions" title="Permalink to this heading">#</a></h2>
</section>
<section id="coaddition">
<h2>Coaddition<a class="headerlink" href="#coaddition" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>reprojection techniques</p></li>
<li><p>average vs median combination, little demo that avg is better in terms of noise.</p></li>
</ul>
<aside class="sidebar">
<p class="sidebar-title">Average or median?</p>
<p>Assuming an ideal situation without any outliers, is it better to average-combine or median-combine images?</p>
<p>For a large number of samples from a normal distribution, the standard error of the median will be <span class="math notranslate nohighlight">\(\sqrt{\pi/2} = 1.25\)</span> times higher, or 25% greater, than the standard error of the mean.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Median">https://en.wikipedia.org/wiki/Median</a></p>
</aside>
<div class="admonition-question admonition">
<p class="admonition-title">Question</p>
<p>Why is combining several exposures usually better than taking a single exposure with a long exposure time?</p>
<div class="dropdown admonition hint">
<p class="admonition-title">Hint</p>
<p>Saturation, tracking, cosmic rays</p>
</div>
</div>
</section>
<section id="photometry">
<h2>Photometry<a class="headerlink" href="#photometry" title="Permalink to this heading">#</a></h2>
<p>The brightness measurement of objects on an image is called <em>photometry</em>. There are two main approaches to photometry on CCD images: digital aperture photometry, and PSF fitting.</p>
<p><span id="id1">[<a class="reference internal" href="more.html#id2" title="Frederick R. Chromey. To Measure the Sky: An Introduction to Observational Astronomy. Cambridge University Press, Cambridge, 2016. URL: https://ui.adsabs.harvard.edu/abs/2016mesk.book.....C.">Chromey16</a>]</span></p>
<dl class="simple myst">
<dt>Digital aperture photometry</dt><dd><p>Definition</p>
<p>PSF homogeneization</p>
</dd>
<dt>PSF fitting</dt><dd><p>Definition</p>
</dd>
</dl>
<p>In this tutorial, we make use of <strong>forced photometry</strong>, meaning that we perform photometry by placing apertures at specific pre-defined locations of an image, without first “detecting” sources in that particular image. These locations are defined in sky coordinates in a reference catalog that we build from a reference image. This makes the subsequent analysis particularly easy, as we get consistent photometric catalogs for each exposure.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the sake of simplicity, we ignore here the effect that distortions have on photometry. For the curious: flatfielding links the pixel scale inhomogeneity of the detector to a systematic photometric bias, that in principle needs to be accounted for (either a posteriori or by reprojecting the images on a distortion-free pixel grid).</p>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="installation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Requirements and installation</p>
      </div>
    </a>
    <a class="right-next"
       href="overview-pythontools.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Structure and Python tools</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#telescope-optics">Telescope optics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resolution">Resolution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seeing-and-airmass">Seeing and airmass</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imaging-instrument-the-camera">Imaging instrument: the camera</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imaging-detectors-ccd-or-cmos">Imaging detectors (CCD or CMOS)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#full-well-capacity">Full-well capacity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adc-adu-and-gain">ADC, ADU, and gain</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bit-depth">Bit depth</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bias-level">Bias level</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dark-current">Dark current</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#astronomical-images">Astronomical images</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fits">FITS</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calibration-frames">Calibration frames</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#artifacts-and-cosmic-rays">Artifacts and cosmic rays ?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wcs-distortions">WCS, distortions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coaddition">Coaddition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#photometry">Photometry</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The AIfA telescope team
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
All contents released under <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a>, unless specified otherwise.<br>
<a href="https://astro.uni-bonn.de/de/institut/impressum" target="_blank">Impressum</a>
</p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>